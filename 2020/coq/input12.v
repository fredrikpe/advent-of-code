
Require Import ZArith.BinInt.
Require Import ZArith.BinIntDef.

(* list notation *) Infix "::" := cons (at level 60, right associativity).
Notation "[ ]" := nil (format "[ ]").
Notation "[ x ]" := (cons x nil).
Notation "[ x ; y ; .. ; z ]" := (cons x (cons y .. (cons z nil) ..)).

Inductive turn : Type :=
  | _90
  | _180
  | _270.

Inductive action : Type :=
  | _N (z:Z)
  | _S (z:Z)
  | _E (z:Z)
  | _W (z:Z)
  | _F (z:Z)
  | _L (t:turn)
  | _R (t:turn).


Definition test_input : list action := [
_F 10%Z ;
_N 3%Z ;
_F 7%Z ;
_R _90 ;
_F 11%Z
].

Definition input : list action := [
_F 99%Z ;
_L _180 ;
_W 1%Z ;
_W 3%Z ;
_R _90 ;
_E 5%Z ;
_R _180 ;
_S 4%Z ;
_F 55%Z ;
_L _90 ;
_E 5%Z ;
_S 3%Z ;
_R _180 ;
_N 2%Z ;
_W 3%Z ;
_S 1%Z ;
_F 64%Z ;
_W 4%Z ;
_F 76%Z ;
_N 2%Z ;
_F 7%Z ;
_L _180 ;
_S 2%Z ;
_E 5%Z ;
_S 2%Z ;
_F 87%Z ;
_N 4%Z ;
_L _90 ;
_F 46%Z ;
_R _90 ;
_F 47%Z ;
_W 5%Z ;
_N 4%Z ;
_L _270 ;
_N 5%Z ;
_F 89%Z ;
_L _180 ;
_W 2%Z ;
_N 5%Z ;
_F 69%Z ;
_E 3%Z ;
_L _90 ;
_F 73%Z ;
_L _90 ;
_N 1%Z ;
_F 28%Z ;
_N 4%Z ;
_F 72%Z ;
_L _90 ;
_F 24%Z ;
_R _90 ;
_S 1%Z ;
_F 52%Z ;
_L _90 ;
_W 2%Z ;
_F 39%Z ;
_E 1%Z ;
_L _180 ;
_S 4%Z ;
_W 1%Z ;
_S 2%Z ;
_F 61%Z ;
_E 3%Z ;
_F 37%Z ;
_S 1%Z ;
_W 3%Z ;
_F 8%Z ;
_S 5%Z ;
_L _90 ;
_N 5%Z ;
_E 2%Z ;
_L _180 ;
_F 44%Z ;
_W 3%Z ;
_S 1%Z ;
_R _90 ;
_F 88%Z ;
_N 1%Z ;
_F 75%Z ;
_S 2%Z ;
_W 2%Z ;
_F 37%Z ;
_N 4%Z ;
_E 3%Z ;
_R _90 ;
_F 47%Z ;
_N 5%Z ;
_W 5%Z ;
_L _90 ;
_S 4%Z ;
_E 5%Z ;
_F 7%Z ;
_R _90 ;
_E 5%Z ;
_R _90 ;
_W 2%Z ;
_F 56%Z ;
_S 2%Z ;
_R _270 ;
_S 1%Z ;
_W 3%Z ;
_S 2%Z ;
_W 2%Z ;
_F 79%Z ;
_W 4%Z ;
_N 5%Z ;
_W 3%Z ;
_F 84%Z ;
_L _90 ;
_N 5%Z ;
_E 2%Z ;
_F 48%Z ;
_E 1%Z ;
_L _180 ;
_E 4%Z ;
_L _90 ;
_W 4%Z ;
_E 4%Z ;
_S 4%Z ;
_W 4%Z ;
_F 36%Z ;
_F 93%Z ;
_L _180 ;
_W 5%Z ;
_S 1%Z ;
_E 5%Z ;
_F 96%Z ;
_N 3%Z ;
_E 3%Z ;
_N 2%Z ;
_R _270 ;
_W 5%Z ;
_L _180 ;
_F 24%Z ;
_W 5%Z ;
_S 5%Z ;
_R _180 ;
_W 1%Z ;
_N 5%Z ;
_F 6%Z ;
_R _90 ;
_E 1%Z ;
_F 52%Z ;
_F 77%Z ;
_W 4%Z ;
_F 34%Z ;
_S 3%Z ;
_R _90 ;
_E 1%Z ;
_E 5%Z ;
_N 5%Z ;
_E 1%Z ;
_S 5%Z ;
_R _90 ;
_W 5%Z ;
_N 4%Z ;
_E 3%Z ;
_W 3%Z ;
_L _90 ;
_E 2%Z ;
_L _90 ;
_W 3%Z ;
_W 5%Z ;
_F 49%Z ;
_N 1%Z ;
_F 48%Z ;
_W 3%Z ;
_N 4%Z ;
_E 4%Z ;
_F 100%Z ;
_E 1%Z ;
_R _90 ;
_F 25%Z ;
_S 1%Z ;
_W 2%Z ;
_N 2%Z ;
_W 1%Z ;
_F 25%Z ;
_L _90 ;
_E 2%Z ;
_F 96%Z ;
_W 2%Z ;
_S 1%Z ;
_S 4%Z ;
_F 91%Z ;
_N 2%Z ;
_R _90 ;
_W 4%Z ;
_L _90 ;
_E 4%Z ;
_F 78%Z ;
_L _90 ;
_S 1%Z ;
_W 3%Z ;
_F 56%Z ;
_R _90 ;
_W 1%Z ;
_E 4%Z ;
_L _90 ;
_N 5%Z ;
_E 1%Z ;
_R _90 ;
_F 53%Z ;
_E 5%Z ;
_L _90 ;
_E 2%Z ;
_F 82%Z ;
_E 4%Z ;
_L _90 ;
_W 2%Z ;
_L _180 ;
_F 51%Z ;
_R _270 ;
_F 37%Z ;
_N 5%Z ;
_F 15%Z ;
_E 4%Z ;
_F 16%Z ;
_E 2%Z ;
_S 1%Z ;
_E 4%Z ;
_F 91%Z ;
_N 4%Z ;
_E 5%Z ;
_N 5%Z ;
_L _90 ;
_F 9%Z ;
_W 2%Z ;
_F 64%Z ;
_S 4%Z ;
_F 72%Z ;
_W 2%Z ;
_F 31%Z ;
_S 4%Z ;
_R _90 ;
_F 40%Z ;
_W 3%Z ;
_R _90 ;
_F 50%Z ;
_S 1%Z ;
_F 61%Z ;
_W 3%Z ;
_F 90%Z ;
_N 5%Z ;
_F 76%Z ;
_S 1%Z ;
_L _90 ;
_E 3%Z ;
_R _180 ;
_F 19%Z ;
_L _90 ;
_W 3%Z ;
_F 70%Z ;
_E 3%Z ;
_F 35%Z ;
_R _90 ;
_L _90 ;
_N 1%Z ;
_W 5%Z ;
_R _180 ;
_E 2%Z ;
_N 5%Z ;
_F 34%Z ;
_W 4%Z ;
_S 1%Z ;
_E 1%Z ;
_N 5%Z ;
_E 1%Z ;
_N 2%Z ;
_R _90 ;
_W 4%Z ;
_S 1%Z ;
_L _180 ;
_E 5%Z ;
_F 59%Z ;
_E 1%Z ;
_R _90 ;
_S 2%Z ;
_L _90 ;
_S 4%Z ;
_R _90 ;
_W 2%Z ;
_N 5%Z ;
_F 60%Z ;
_W 1%Z ;
_R _90 ;
_F 35%Z ;
_R _270 ;
_W 5%Z ;
_F 100%Z ;
_W 2%Z ;
_R _90 ;
_N 2%Z ;
_S 5%Z ;
_S 3%Z ;
_E 1%Z ;
_S 2%Z ;
_F 36%Z ;
_W 1%Z ;
_F 90%Z ;
_R _90 ;
_S 3%Z ;
_E 3%Z ;
_F 5%Z ;
_S 4%Z ;
_R _90 ;
_E 3%Z ;
_R _90 ;
_N 3%Z ;
_L _90 ;
_S 1%Z ;
_F 74%Z ;
_S 2%Z ;
_R _180 ;
_E 4%Z ;
_S 5%Z ;
_F 13%Z ;
_S 3%Z ;
_E 2%Z ;
_F 92%Z ;
_N 5%Z ;
_F 2%Z ;
_N 4%Z ;
_F 3%Z ;
_E 2%Z ;
_L _180 ;
_W 3%Z ;
_N 3%Z ;
_L _90 ;
_E 4%Z ;
_F 21%Z ;
_W 1%Z ;
_F 76%Z ;
_W 5%Z ;
_F 56%Z ;
_E 4%Z ;
_R _180 ;
_F 100%Z ;
_E 1%Z ;
_F 29%Z ;
_L _90 ;
_F 96%Z ;
_N 2%Z ;
_F 43%Z ;
_R _90 ;
_F 26%Z ;
_N 3%Z ;
_F 15%Z ;
_L _180 ;
_E 3%Z ;
_R _180 ;
_N 3%Z ;
_E 3%Z ;
_R _90 ;
_F 7%Z ;
_L _90 ;
_W 2%Z ;
_F 33%Z ;
_R _90 ;
_E 5%Z ;
_S 4%Z ;
_E 2%Z ;
_E 3%Z ;
_F 34%Z ;
_F 66%Z ;
_N 4%Z ;
_F 14%Z ;
_W 3%Z ;
_N 2%Z ;
_R _270 ;
_F 66%Z ;
_E 4%Z ;
_S 5%Z ;
_W 5%Z ;
_R _90 ;
_S 5%Z ;
_W 5%Z ;
_L _90 ;
_S 4%Z ;
_L _90 ;
_F 69%Z ;
_E 5%Z ;
_R _90 ;
_W 5%Z ;
_S 5%Z ;
_W 4%Z ;
_R _90 ;
_N 3%Z ;
_E 4%Z ;
_F 14%Z ;
_W 3%Z ;
_F 24%Z ;
_S 3%Z ;
_F 48%Z ;
_L _180 ;
_E 1%Z ;
_R _90 ;
_F 36%Z ;
_N 4%Z ;
_L _90 ;
_F 68%Z ;
_E 4%Z ;
_F 59%Z ;
_E 5%Z ;
_R _90 ;
_N 2%Z ;
_E 4%Z ;
_N 5%Z ;
_F 56%Z ;
_R _90 ;
_R _90 ;
_F 91%Z ;
_W 3%Z ;
_F 24%Z ;
_L _90 ;
_F 56%Z ;
_S 5%Z ;
_F 59%Z ;
_S 4%Z ;
_F 36%Z ;
_N 1%Z ;
_W 3%Z ;
_R _270 ;
_L _90 ;
_F 86%Z ;
_L _180 ;
_F 33%Z ;
_N 5%Z ;
_E 4%Z ;
_L _90 ;
_F 14%Z ;
_S 3%Z ;
_L _90 ;
_N 5%Z ;
_L _270 ;
_E 5%Z ;
_S 4%Z ;
_L _180 ;
_W 5%Z ;
_N 2%Z ;
_L _90 ;
_E 3%Z ;
_F 69%Z ;
_R _90 ;
_S 5%Z ;
_R _270 ;
_N 3%Z ;
_F 70%Z ;
_E 2%Z ;
_N 2%Z ;
_F 3%Z ;
_R _90 ;
_S 5%Z ;
_L _180 ;
_F 59%Z ;
_W 3%Z ;
_F 67%Z ;
_R _180 ;
_F 74%Z ;
_E 4%Z ;
_F 4%Z ;
_L _90 ;
_N 4%Z ;
_R _90 ;
_S 5%Z ;
_F 6%Z ;
_S 1%Z ;
_E 3%Z ;
_N 4%Z ;
_W 3%Z ;
_F 24%Z ;
_E 1%Z ;
_S 1%Z ;
_E 4%Z ;
_S 2%Z ;
_F 82%Z ;
_N 3%Z ;
_L _90 ;
_E 1%Z ;
_S 2%Z ;
_R _270 ;
_N 4%Z ;
_E 1%Z ;
_N 3%Z ;
_F 32%Z ;
_R _270 ;
_W 4%Z ;
_R _90 ;
_E 4%Z ;
_F 33%Z ;
_N 5%Z ;
_W 3%Z ;
_F 34%Z ;
_E 2%Z ;
_S 1%Z ;
_W 3%Z ;
_W 4%Z ;
_E 2%Z ;
_L _90 ;
_N 5%Z ;
_W 3%Z ;
_S 1%Z ;
_F 86%Z ;
_E 4%Z ;
_F 99%Z ;
_S 1%Z ;
_L _90 ;
_S 2%Z ;
_E 2%Z ;
_L _90 ;
_F 100%Z ;
_N 5%Z ;
_F 19%Z ;
_L _180 ;
_W 1%Z ;
_F 25%Z ;
_N 3%Z ;
_F 25%Z ;
_R _90 ;
_W 4%Z ;
_N 4%Z ;
_R _180 ;
_N 2%Z ;
_E 5%Z ;
_R _90 ;
_F 66%Z ;
_N 5%Z ;
_E 2%Z ;
_L _180 ;
_L _90 ;
_E 1%Z ;
_S 2%Z ;
_R _90 ;
_W 3%Z ;
_S 1%Z ;
_S 2%Z ;
_L _90 ;
_F 93%Z ;
_L _90 ;
_W 2%Z ;
_R _270 ;
_F 73%Z ;
_N 4%Z ;
_L _90 ;
_F 44%Z ;
_R _90 ;
_N 1%Z ;
_W 3%Z ;
_R _90 ;
_F 69%Z ;
_N 5%Z ;
_L _90 ;
_N 1%Z ;
_R _90 ;
_F 35%Z ;
_F 89%Z ;
_E 4%Z ;
_F 31%Z ;
_W 3%Z ;
_R _270 ;
_W 1%Z ;
_N 2%Z ;
_E 5%Z ;
_L _90 ;
_W 4%Z ;
_W 1%Z ;
_F 93%Z ;
_E 4%Z ;
_F 18%Z ;
_N 4%Z ;
_F 31%Z ;
_W 5%Z ;
_N 4%Z ;
_L _90 ;
_N 1%Z ;
_E 2%Z ;
_R _270 ;
_F 34%Z ;
_N 5%Z ;
_W 2%Z ;
_L _270 ;
_W 3%Z ;
_F 44%Z ;
_S 3%Z ;
_F 47%Z ;
_W 2%Z ;
_F 86%Z ;
_N 4%Z ;
_R _90 ;
_S 5%Z ;
_R _90 ;
_F 4%Z ;
_E 3%Z ;
_L _180 ;
_W 5%Z ;
_R _180 ;
_F 89%Z ;
_L _180 ;
_F 46%Z ;
_N 3%Z ;
_F 76%Z ;
_R _270 ;
_S 2%Z ;
_F 62%Z ;
_R _90 ;
_S 2%Z ;
_F 28%Z ;
_R _180 ;
_F 47%Z ;
_E 4%Z ;
_N 4%Z ;
_R _90 ;
_S 4%Z ;
_E 3%Z ;
_R _180 ;
_N 1%Z ;
_F 92%Z ;
_R _180 ;
_F 86%Z ;
_N 3%Z ;
_R _270 ;
_F 47%Z ;
_E 4%Z ;
_S 4%Z ;
_W 2%Z ;
_F 67%Z ;
_N 5%Z ;
_W 3%Z ;
_N 1%Z ;
_F 98%Z ;
_S 1%Z ;
_E 4%Z ;
_N 3%Z ;
_F 97%Z ;
_E 3%Z ;
_F 69%Z ;
_E 3%Z ;
_F 38%Z ;
_E 3%Z ;
_S 4%Z ;
_E 5%Z ;
_F 81%Z ;
_E 3%Z ;
_F 5%Z ;
_E 3%Z ;
_R _90 ;
_W 2%Z ;
_N 4%Z ;
_W 3%Z ;
_F 94%Z ;
_L _180 ;
_F 30%Z ;
_N 1%Z ;
_F 91%Z ;
_S 3%Z ;
_F 89%Z ;
_E 1%Z ;
_F 68%Z ;
_N 5%Z ;
_E 5%Z ;
_F 89%Z ;
_L _90 ;
_W 1%Z ;
_N 5%Z ;
_F 79%Z ;
_R _90 ;
_F 44%Z ;
_E 4%Z ;
_R _90 ;
_S 1%Z ;
_L _90 ;
_E 5%Z ;
_N 3%Z ;
_R _90 ;
_W 3%Z ;
_N 4%Z ;
_F 83%Z ;
_E 5%Z ;
_S 4%Z ;
_F 82%Z ;
_S 2%Z ;
_F 29%Z ;
_R _90 ;
_S 1%Z ;
_R _180 ;
_F 49%Z ;
_E 5%Z ;
_N 1%Z ;
_L _180 ;
_R _180 ;
_S 3%Z ;
_L _180 ;
_S 3%Z ;
_F 55%Z ;
_S 3%Z ;
_F 70%Z ;
_W 5%Z ;
_N 2%Z ;
_W 2%Z ;
_R _90 ;
_W 1%Z ;
_F 93%Z ;
_L _180 ;
_L _90 ;
_R _90 ;
_L _90 ;
_E 3%Z ;
_L _90 ;
_S 3%Z ;
_R _90 ;
_W 5%Z ;
_N 4%Z ;
_R _90 ;
_S 1%Z ;
_R _90 ;
_W 5%Z ;
_F 100%Z ;
_W 4%Z ;
_N 2%Z ;
_F 84%Z ;
_F 76%Z ;
_E 5%Z ;
_L _180 ;
_S 4%Z ;
_F 85%Z ;
_R _90 ;
_L _90 ;
_F 68%Z ;
_R _90 ;
_S 4%Z ;
_W 2%Z ;
_L _90 ;
_E 1%Z ;
_F 19%Z ;
_N 2%Z ;
_L _90 ;
_N 4%Z ;
_E 5%Z ;
_N 1%Z ;
_L _90 ;
_F 75%Z ;
_F 42%Z ;
_R _90 ;
_S 5%Z ;
_E 4%Z ;
_N 1%Z ;
_E 4%Z ;
_F 7%Z ;
_N 5%Z ;
_L _180 ;
_N 4%Z ;
_E 5%Z ;
_L _270 ;
_F 6%Z ;
_R _180 ;
_W 5%Z ;
_F 93%Z ;
_L _180 ;
_S 1%Z ;
_R _90 ;
_F 66%Z ;
_N 4%Z ;
_F 83%Z ;
_N 1%Z ;
_F 10%Z ;
_S 2%Z ;
_L _90 ;
_F 80%Z ;
_W 1%Z ;
_R _180 ;
_E 2%Z ;
_L _90 ;
_S 4%Z ;
_F 53%Z
].

